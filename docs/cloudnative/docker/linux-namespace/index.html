<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cloudnative/docker/linux-namespace" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Linux Namespace | 黄昏别馆</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://idukelu.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://idukelu.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://idukelu.com/docs/cloudnative/docker/linux-namespace/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Linux Namespace | 黄昏别馆"><meta data-rh="true" name="description" content="什么是 Linux Namespace ？"><meta data-rh="true" property="og:description" content="什么是 Linux Namespace ？"><link data-rh="true" rel="icon" href="https://github.com/idukelu.png"><link data-rh="true" rel="canonical" href="https://idukelu.com/docs/cloudnative/docker/linux-namespace/"><link data-rh="true" rel="alternate" href="https://idukelu.com/docs/cloudnative/docker/linux-namespace/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://idukelu.com/docs/cloudnative/docker/linux-namespace/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="黄昏别馆 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="黄昏别馆 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.b3c33adb.css">
<script src="/assets/js/runtime~main.b95a302c.js" defer="defer"></script>
<script src="/assets/js/main.48a0906a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><div class="announcementBar_mb4j" style="background-color:#f15757;color:#091E42" role="banner"><div class="content_knG7 announcementBarContent_xLdY">历史博客逐步迁移中... 敬请期待！</div></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://github.com/idukelu.png" alt="Sunset Manor" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://github.com/idukelu.png" alt="Sunset Manor" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">黄昏别馆</b></a><a class="navbar__item navbar__link" href="/docs/golang/">Golang</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/cloudnative/docker/">云原生</a><a class="navbar__item navbar__link" href="/docs/database/mysql/">数据库</a><a class="navbar__item navbar__link" href="/docs/algorithm/sort/">算法</a><a class="navbar__item navbar__link" href="/blog/">随笔</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">其他</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/java/java-collections/">Java</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/cloudnative/docker/">Docker</a><button aria-label="折叠侧边栏分类 &#x27;Docker&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cloudnative/docker/docker-install/">Docker 的安装与卸载</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cloudnative/docker/image-acceleration/">Docker 镜像加速</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cloudnative/docker/software-install/">常用软件安装</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/cloudnative/docker/linux-namespace/">Linux Namespace</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cloudnative/docker/linux-cgroups/">Linux Cgroups</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cloudnative/docker/linux-veth-pair/">Linux Veth Pair</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cloudnative/docker/linux-bridge/">Linux Bridge</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cloudnative/kubernetes/">Kubernetes</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/cloudnative/docker/"><span itemprop="name">Docker</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Linux Namespace</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Linux Namespace</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="什么是-linux-namespace-">什么是 Linux Namespace ？<a href="#什么是-linux-namespace-" class="hash-link" aria-label="什么是 Linux Namespace ？的直接链接" title="什么是 Linux Namespace ？的直接链接">​</a></h2>
<blockquote>
<p>A namespace wraps a global system resource in an abstraction that makes it appear to the processes within the namespace that they have their own isolated instance of the global resource. Changes to the global resource are visible to other processes that are members of the namespace, but are invisible to other processes. One use of namespaces is to implement containers.</p>
</blockquote>
<p>Linux Namespace 是 Linux 内核提供的一种轻量级的虚拟化技术，用于隔离和虚拟化系统资源，它们可以将全局系统资源隔离到不同的独立空间，使不同的进程组拥有各自独立的资源视图。每个命名空间的目的是将特定的全局系统资源包装在抽象中，使命名空间内的进程看起来拥有自己的全局资源的隔离实例。   命名空间的总体目标之一是支持容器的实现，容器是一种用于轻量级虚拟化（以及其他目的）的工具，它为一组进程提供了它们是系统上唯一进程的错觉。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>总结</div><div class="admonitionContent_BuS1"><p>Linux Namespace 是 Linux 内核提供的一种机制，一种轻量级的虚拟化技术，用于<strong>隔离和虚拟化系统资源</strong>。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="linux-namespace-分类">Linux Namespace 分类<a href="#linux-namespace-分类" class="hash-link" aria-label="Linux Namespace 分类的直接链接" title="Linux Namespace 分类的直接链接">​</a></h2>
<p>通过以下命令即可查看有哪些 Linux Namespace：</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> /proc/</span><span class="token variable" style="color:#36acaa">$$</span><span class="token plain">/ns </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{print $1, $9, $10, $11}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">total </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx. cgroup -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cgroup:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026531835</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx. ipc -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ipc:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026531839</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx. mnt -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mnt:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026531840</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx. net -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> net:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026531969</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx. pid -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pid:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026531836</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx. pid_for_children -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pid:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026531834</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx. </span><span class="token function" style="color:#d73a49">time</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> time:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026531834</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx. time_for_children -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> time:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026531834</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx. user -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> user:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026531837</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx. uts -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> uts:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026531838</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>目前，Linux 已经支持 8 种全局资源的虚拟化 (每种资源都是随着 Linux 内核版本的迭代而逐渐加入的，因此有些内核版本可能不具备某种 Namespace)：</p>
<table><thead><tr><th><strong>Namespace</strong></th><th><strong>隔离资源 (Isolates)</strong></th><th><strong>参考</strong></th><th><strong>内核版本</strong></th></tr></thead><tbody><tr><td><strong>Mount Namespace</strong></td><td>Mount points</td><td><a href="https://man.archlinux.org/man/mount_namespaces.7.en" target="_blank" rel="noopener noreferrer">mount_namespaces(7)</a></td><td>2.4.19</td></tr><tr><td><strong>UTS Namespace</strong></td><td>Hostname and NIS domain name</td><td><a href="https://man.archlinux.org/man/uts_namespaces.7.en" target="_blank" rel="noopener noreferrer">uts_namespaces(7)</a></td><td>2.6.19</td></tr><tr><td><strong>IPC Namespace</strong></td><td>System V IPC, POSIX message queues</td><td><a href="https://man.archlinux.org/man/ipc_namespaces.7.en" target="_blank" rel="noopener noreferrer">ipc_namespaces(7)</a></td><td>2.6.19</td></tr><tr><td><strong>PID Namespace</strong></td><td>Process IDs</td><td><a href="https://man.archlinux.org/man/pid_namespaces.7.en" target="_blank" rel="noopener noreferrer">pid_namespaces(7)</a></td><td>2.6.24</td></tr><tr><td><strong>Network Namespace</strong></td><td>Network devices, stacks, ports, etc.</td><td><a href="https://man.archlinux.org/man/network_namespaces.7.en" target="_blank" rel="noopener noreferrer">network_namespaces(7)</a></td><td>2.6.24</td></tr><tr><td><strong>User Namespace</strong></td><td>User and group IDs</td><td><a href="https://man.archlinux.org/man/user_namespaces.7.en" target="_blank" rel="noopener noreferrer">user_namespaces(7)</a></td><td>3.8</td></tr><tr><td><strong>Cgroup Namespace</strong></td><td>Cgroup root directory</td><td><a href="https://man.archlinux.org/man/cgroup_namespaces.7.en" target="_blank" rel="noopener noreferrer">cgroup_namespaces(7)</a></td><td>4.6</td></tr><tr><td><strong>Time Namespace</strong></td><td>Boot and monotonic clocks</td><td><a href="https://man.archlinux.org/man/time_namespaces.7.en" target="_blank" rel="noopener noreferrer">time_namespaces(7)</a></td><td>5.6</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="linux-namespace-api">Linux Namespace API<a href="#linux-namespace-api" class="hash-link" aria-label="Linux Namespace API的直接链接" title="Linux Namespace API的直接链接">​</a></h2>
<p>Linux Namespaces 提供了一组 API，使得开发者能够创建、操作和管理不同的 namespaces。这些 API 主要包括：</p>
<ul>
<li><code>clone</code>: 创建一个新的进程，并将这个进程加入指定的 namespaces。</li>
<li><code>unshare</code>: 将调用进程移动到新的 namespace。</li>
<li><code>setns</code>: 允许调用进程加入现有的 namespace。</li>
</ul>
<p>其他 API：</p>
<ul>
<li><code>readlink</code>: 用于读取符号链接。可以读取 /proc/[pid]/ns/ 目录下的 namespace 符号链接，获取 namespace 类型和标识。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="linux-namespace-的生命周期">Linux Namespace 的生命周期<a href="#linux-namespace-的生命周期" class="hash-link" aria-label="Linux Namespace 的生命周期的直接链接" title="Linux Namespace 的生命周期的直接链接">​</a></h2>
<p>通常情况下，当一个 namespace 中的最后一个进程终止或离开该 namespace 时，namespace 会被自动销毁。</p>
<p>一些特殊情况下，有一些因素可能会使得即使没有成员进程，namespace 依然存在。包括：</p>
<ul>
<li>打开的文件描述符或绑定挂载点：如果存在一个打开的文件描述符指向 /proc/pid/ns/* 文件，或对该文件的绑定挂载点，这些引用会使 namespace 保持存在。</li>
<li>层次化的 namespace：某些 namespace（如 PID namespace 或 User namespace）是层次化的。如果一个 namespace 有子 namespace 存在，那么该 namespace 会继续存在。</li>
<li>User namespace 拥有非用户 namespace：如果一个 User namespace 拥有一个或多个非用户 namespace（如网络 namespace、IPC namespace 等），那么这个 User namespace 会保持存在。</li>
<li>通过符号链接引用的 PID namespace：如果有进程通过 /proc/pid/ns/pid_for_children 符号链接引用该 PID namespace，那么该 PID namespace 会保持存在。</li>
<li>通过符号链接引用的 Time namespace：如果有进程通过 /proc/pid/ns/time_for_children 符号链接引用该 Time namespace，那么该 Time namespace 会保持存在。</li>
<li>引用 IPC namespace 的 mqueue 文件系统挂载：如果一个 mqueue 文件系统挂载对应于某个 IPC namespace，那么该 IPC namespace 会保持存在。</li>
<li>引用 PID namespace 的 proc 文件系统挂载：如果一个 proc 文件系统挂载对应于某个 PID namespace，那么该 PID namespace 会保持存在。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="linux-namespace-在-docker-中的使用">Linux Namespace 在 Docker 中的使用<a href="#linux-namespace-在-docker-中的使用" class="hash-link" aria-label="Linux Namespace 在 Docker 中的使用的直接链接" title="Linux Namespace 在 Docker 中的使用的直接链接">​</a></h2>
<p>我们启动一个容器，看看 Docker 是如何通过 Namespace 隔离相关资源的：</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">~ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> nginx</span><br></span><span class="token-line code-block-highlighting-line" style="color:#393A34"><span class="token plain">c4ac920a44697897447ee0325f13926298193be2eddb0aa56f397352fe437fec</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>通过容器找到进程在宿主机的 PID</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">～ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> inspect </span><span class="token parameter variable" style="color:#36acaa">--format</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{{.State.Pid}}&#x27;</span><span class="token plain"> c4ac920a4469</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">551330</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 找一下 551330 的父 PID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">～ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ppid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">551330</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">551307</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 看一下父 PID 551307 的进程树</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">～ pstree </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">551307</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">containerd-shim</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">551307</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">───nginx</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">551330</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">─┬─nginx</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">551374</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        └─nginx</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">551375</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 看一下 551307、551330、551374、551375 具体的进程</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">551307</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">551330</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">551374</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">551375</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PID TTY      STAT   TIME COMMAND</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">551307</span><span class="token plain"> ?        Sl     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:03 /usr/bin/containerd-shim-runc-v2 </span><span class="token parameter variable" style="color:#36acaa">-namespace</span><span class="token plain"> moby </span><span class="token parameter variable" style="color:#36acaa">-id</span><span class="token plain"> c4ac920a44697897447ee0325f13926298193be2eddb0aa56f397352fe437fec </span><span class="token parameter variable" style="color:#36acaa">-address</span><span class="token plain"> /run/containe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">551330</span><span class="token plain"> ?        Ss     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 nginx: master process nginx </span><span class="token parameter variable" style="color:#36acaa">-g</span><span class="token plain"> daemon off</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">551374</span><span class="token plain"> ?        S      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 nginx: worker process</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">551375</span><span class="token plain"> ?        S      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 nginx: worker process</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以看出，PID 551330 确实是由 Docker 启动的 nginx 进程</p>
<br>
<p>查看当前主机的 namespace 情况：</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## 查看 namespace 列表</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~ lsns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        NS TYPE  NPROCS    PID </span><span class="token environment constant" style="color:#36acaa">USER</span><span class="token plain">   COMMAND</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4026531836</span><span class="token plain"> pid       </span><span class="token number" style="color:#36acaa">86</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root   /usr/lib/systemd/systemd --switched-root </span><span class="token parameter variable" style="color:#36acaa">--system</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--deserialize</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4026531837</span><span class="token plain"> user      </span><span class="token number" style="color:#36acaa">89</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root   /usr/lib/systemd/systemd --switched-root </span><span class="token parameter variable" style="color:#36acaa">--system</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--deserialize</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4026531838</span><span class="token plain"> uts       </span><span class="token number" style="color:#36acaa">86</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root   /usr/lib/systemd/systemd --switched-root </span><span class="token parameter variable" style="color:#36acaa">--system</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--deserialize</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4026531839</span><span class="token plain"> ipc       </span><span class="token number" style="color:#36acaa">86</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root   /usr/lib/systemd/systemd --switched-root </span><span class="token parameter variable" style="color:#36acaa">--system</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--deserialize</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4026531840</span><span class="token plain"> mnt       </span><span class="token number" style="color:#36acaa">84</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root   /usr/lib/systemd/systemd --switched-root </span><span class="token parameter variable" style="color:#36acaa">--system</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--deserialize</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4026531856</span><span class="token plain"> mnt        </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> root   kdevtmpfs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4026531956</span><span class="token plain"> net       </span><span class="token number" style="color:#36acaa">86</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root   /usr/lib/systemd/systemd --switched-root </span><span class="token parameter variable" style="color:#36acaa">--system</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--deserialize</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"></span><br></span><span class="token-line code-block-highlighting-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4026532160</span><span class="token plain"> mnt        </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">559</span><span class="token plain"> chrony /usr/sbin/chronyd</span><br></span><span class="token-line code-block-highlighting-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4026532308</span><span class="token plain"> mnt        </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">551330</span><span class="token plain"> root   nginx: master process nginx </span><span class="token parameter variable" style="color:#36acaa">-g</span><span class="token plain"> daemon off</span><br></span><span class="token-line code-block-highlighting-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4026532309</span><span class="token plain"> uts        </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">551330</span><span class="token plain"> root   nginx: master process nginx </span><span class="token parameter variable" style="color:#36acaa">-g</span><span class="token plain"> daemon off</span><br></span><span class="token-line code-block-highlighting-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4026532310</span><span class="token plain"> ipc        </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">551330</span><span class="token plain"> root   nginx: master process nginx </span><span class="token parameter variable" style="color:#36acaa">-g</span><span class="token plain"> daemon off</span><br></span><span class="token-line code-block-highlighting-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4026532311</span><span class="token plain"> pid        </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">551330</span><span class="token plain"> root   nginx: master process nginx </span><span class="token parameter variable" style="color:#36acaa">-g</span><span class="token plain"> daemon off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4026532313</span><span class="token plain"> net        </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">551330</span><span class="token plain"> root   nginx: master process nginx </span><span class="token parameter variable" style="color:#36acaa">-g</span><span class="token plain"> daemon off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 确认 PID 551330 下是否有这些 namespace</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~ ll /proc/551330/ns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">月  </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:21 ipc -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ipc:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026532310</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">月  </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:21 mnt -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mnt:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026532308</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">月  </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> 01:22 net -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> net:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026532313</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">月  </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> 01:23 pid -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pid:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026532311</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">月  </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:21 user -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> user:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026531837</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">月  </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:21 uts -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> uts:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4026532309</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以看出，Docker 为 nginx 容器创建了新的 namespace (mnt、uts、ipc、pid、net)，并将 PID 为 551330 的进程加入了这些 namespace。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a href="#总结" class="hash-link" aria-label="总结的直接链接" title="总结的直接链接">​</a></h2>
<p>Linux Namespace：Linux 内核提供的一种机制，一种轻量级的虚拟化技术，用于<strong>隔离和虚拟化系统资源</strong>。</p>
<p>8 种全局资源的虚拟化（内核版本不同，支持的 Namespace 可能不同）：</p>
<ul>
<li>Mount: 隔离文件挂载点</li>
<li>UTS: 隔离主机名、域名</li>
<li>IPC: 隔离进程通信资源 (System V IPC, POSIX message queues)</li>
<li>PID: 隔离进程 ID</li>
<li>Network: 隔离网络设备、网络协议栈、路由表、IP 地址、端口</li>
<li>User: 隔离用户、用户组</li>
<li>Cgroup: 隔离 Cgroup 根目录</li>
<li>Time: 隔离系统时间、单调时间</li>
</ul>
<p>生命周期：</p>
<ul>
<li>通常情况，namespace 最后一个进程终止或离开时，namespace 会被自动销毁。</li>
<li>特殊情况下，有一些因素可能会使得即使没有成员进程，namespace 依然存在。</li>
</ul>
<p>Linux Namespace 在 Docker 中的应用：</p>
<ul>
<li>Docker 会为每个容器中的进程创建新的 namespace，并将启动的进程加入这些新的 namespace，最后通过这些 namespace 实现资源的隔离。</li>
</ul>
<hr>
<p>参考：</p>
<ul>
<li><a href="https://lwn.net/Articles/531114/" target="_blank" rel="noopener noreferrer">Namespaces in operation</a></li>
<li><a href="https://man.archlinux.org/man/namespaces.7.en" target="_blank" rel="noopener noreferrer">man 7 namespaces</a></li>
<li><a href="https://en.wikipedia.org/wiki/Linux_namespaces" target="_blank" rel="noopener noreferrer">Linux Namespaces - 维基百科</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/云原生/">云原生</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/docker/">Docker</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/linux/">Linux</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/cloudnative/docker/software-install/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">常用软件安装</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/cloudnative/docker/linux-cgroups/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Linux Cgroups</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#什么是-linux-namespace-" class="table-of-contents__link toc-highlight">什么是 Linux Namespace ？</a></li><li><a href="#linux-namespace-分类" class="table-of-contents__link toc-highlight">Linux Namespace 分类</a></li><li><a href="#linux-namespace-api" class="table-of-contents__link toc-highlight">Linux Namespace API</a></li><li><a href="#linux-namespace-的生命周期" class="table-of-contents__link toc-highlight">Linux Namespace 的生命周期</a></li><li><a href="#linux-namespace-在-docker-中的使用" class="table-of-contents__link toc-highlight">Linux Namespace 在 Docker 中的使用</a></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 iDukeLu, Inc.</div></div></div></footer></div>
</body>
</html>